# 3813ICT Assignment

## Git
The git repository has the server folder (for the backend) and the src folder from the angular project as well as a few angular config files. The repository has 2 branches. One of them (named phase-1) has all the stuff done for the phase 1 submission. The other one (named phase-2) will be where all the stuff for the phase 2 submission will be done. This will be merged into master before submission. The approach that was taken for version control was to make a new commit after a milestone was achieved (e.g. adding the ability to create groups).

## Data Structures
The main data for the server is stored in a mongoDB database. This database has two collections: users and groups. The users are stored as an array of objects that contain the data for the user. The data that users can have is their username as a string, their email as a string, their role as a string, an array of the names of groups that they are a group assistant for, their password as a string and their profile picture as a string. The groups are also stored as an array of objects that contain the data for the group. The data that groups can have is their name as a string, an object that contains the channels and an array that contains the usernames of the users that have access to the group. The object that contains the channels for a group is a map with the channel name as the key and an object with the channel data for the value. The data that channels can have is an array of the usernames of the users that have access to the channel and an array of objects that contain the data of chat messages that have been sent in the channel. The data that chat messages can have is the user who sent the message as a string, the text in the message as a string and an attached image as a string.

## Routes
The backend node has fourteen routes. The routes are addRemoveGroupAssis, addRemoveGroupChannelUser, addRemoveUser, checkUserAuthorised, createGroupChannel, deleteGroupChannel, getAuthorisedGroupChannels, getAuthorisedGroupChannelUsers, getChat, getProfilePics, getUserData, getUsers, login and updateUser. All routes first check if all the needed data for the request was supplied and that the user is authorised to do the request before they process the request. The addRemoveGroupAssis route takes the name of the user that sent the request as a string, the name of the user that is being added or removed from being a group assitant as a string, the name of the group as a string and whether the user is getting removed from being a group assistant as a boolean. This route updates the user collection in the database to add or remove the group from the users list of groups that they are group assistants for and returns nothing. The addRemoveGroupChannelUser route takes the name of the user that sent the request as a string, the name of the user that is being added or removed from the group or channel as a string, the name of the group as a string, optionally, the name of the channel as a string and whether the user is being removed as a boolean. The route updates group collection of the database to add or remove the user to the allowed users array of the channel if it was supplied, otherwise, to the allowed users array of the group and returns nothing. The addRemoveUser route takes the name of the user that sent the request as a string, the data of the user that is going to be added or removed as an object and whether the user is being removed as a boolean. This route adds or removes the users entry from the users collection of the database and returns that it was successful if the user was successfully added and nothing otherwise. The checkUserAuthorised route takes the name of the user to be checked as a string, the minimum authentication level as string and optionally, the name of the group the user needs to be a group assistant for (for when the minimum authentication level is group assistant). The route checks if the user meets the minimum authentication level requirement and returns true if they do or false if they don't. The createGroupChannel route takes the name of the user that sent the request as a string, the name of the group to be created, and optionally, the name of the channel to be created. The route updates the groups collection of the database to add the channel to the array of channels in the group if a channel name was supplied, otherwise, it adds a new group to the collection and returns nothing. The deleteGroupChannel route takes the name of the user that sent the request as a string, the name of the group to be deleted, and optionally, the name of the channel to be deleted. The route updates the groups collection of the database to remove the channel from the array of channels in the group if a channel name was supplied, otherwise, it removes the group from the collection and returns nothing. The getAuthorisedGroupChannels route takes the name of the user who sent the request. This route checks all the groups in the groups collection of the database for ones that the user is authorised to access, then checks all the channels in these groups for ones that the user is authorised to access and returns the names of these groups and channels as an object. The getAuthorisedGroupChannelUsers route takes the name of the user who sent the request as a string and the name of the group that the authorised users of is wanted to be obtained as a string. The route gets all the users from the users collection of the database, checks if they are authorised to view the group, checks if they are authorised to view each channel and returns this information as an object. The getChat route takes the name of the user who sent the request as a string, the name of the group the chat is in as a string and the name of the channel the chat is for as a string. The route gets chat array from the specified channel in the specified group in the groups collection of the database and returns it. The getProfilePics route takes nothing. The route loops through all the users in the users collection of the database and returns a map with the names of all the users as the key and their profile picture as the value. The getUserData route takes the name of the user who sent the request as a string. This route gets the data of the user who sent the request from the users collection of the database, extracts the email, password and profile picture, and returns the result. The getUsers route takes the name of the user who sent the request as a string. The route loops through all the users in the users collection of the database, gets their username, email and role, and returns this data after it ahs finished looping through all the users. The login route takes the username of the accountthe user is trying to login as, as a string and the password that the user gave as a string. The route checks if the username belongs to a valid user and that the password matches. If both these conditions are met, the name of the user is returned, otherwise, nothing is returned. The updateUser route takes the name of the user who sent the request as a string, the name of the user that is being updated as a string and the data that the user is reqesting be updated as an object. The route checks if the user exists and if it does, updates the data of the user and returns nothing.

## Architecture
The frontend angular server has six components and two services. The components are chat, groups, login, manage-group-users, profile and users. The services are backend and data. The main component of the app (app) contains a nav bar that allows you to log out, go to the groups page, go to the users page (if you are authorised to do so) and go to the profile page. It also handles redirecting to the login page if the user is not logged in. The chat component lets the user view and send messages to the chat of a channel in a group. It needs to be supplied the name of the group and channel that the user joined the chat of. The groups channel is used to join the channels of groups you are authorised to join. If you have a role that is authorised to do these things, it also allows adding and removing groups and channels and allows you to go to the manage-group-usres page for a group. The login component has an input for the users username, one for there password and and a login button and is usedby the user to login. The manage-group-users component is used for adding and removing users from groups and channels and for making and removing users as group assistants if the logged in user is authorised to do so. The profile component is used to change the current logged in users email, password and profile picture. The users component is used to add, remove and change the role of users (excluding the currently logged in user). The backend service is used to send post requests to the backend server. The data service is used to call the post request function in the backend service and supply it with the necessary data.
